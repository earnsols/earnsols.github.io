<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Earn Bitz</title>
  <style>
    /* Styles for layout, popups, and other elements */
    * {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      
    }

    body {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      background: linear-gradient(to right top, red, rgb(237, 104, 3));
      color: white;
      font-size: 1rem;
    }

    header {
      text-align: center;
      padding: 20px;
      font-size: 2.5em;
      color: white;
    }
    .edit-profile-btn{
      background-color: rgb(237, 104, 3);
      color: white;
      border: none;
      padding: 10px 20px;
      cursor: pointer;
      border-radius: 5px;
    }

    #logout-button {
      position: absolute;
      top: 20px;
      left: 10px;
      background-color: white;
      color: rgb(237, 104, 3);
      border: none;
      padding: 10px 20px;
      cursor: pointer;
      border-radius: 5px;
    }

    #logout-button:hover {
      background-color: rgb(237, 104, 3);
      color: white;
    }

    #notifications-icon {
      position: absolute;
      top: 20px;
      right: 20px;
      width: 50px;
      height: 50px;
      cursor: pointer;
      filter: invert(100);
    }

    .main-content {
      flex-grow: 1;
      display: flex;
      padding: 2px;
      text-align: center;
      background-color: #fff;
      color: rgb(237, 104, 3);
      flex-direction: column;
    }

    .bottom-nav {
      display: flex;
      justify-content: space-around;
      align-items: center;
      background-color: rgb(237, 104,3);
      padding: 10px 0;
      border-top: 2px solid rgb(237, 104, 3);
    }

    .bottom-nav img {
      width: 50px;
      height: 50px;
      cursor: pointer;
      filter: invert(100%) hue-rotate(-10deg) saturate(30%); /* Change the filter for orange-red color */
    }

    footer {
      text-align: center;
      padding: 10px;
      background-color: rgb(237, 104, 3);
      color: white;
    }

    .game-image {
      width: 80px;
      height: 80px;
      cursor: pointer;
      transition: transform 0.3s ease;
      margin-right: 5px;
    }

    .game-image:hover {
      transform: scale(1.2);
    }

    ul {
      list-style-type: none;
      padding: 0;
      margin: 0;
      display: flex;
      margin-left: 50px;
    }

    ul li {
      margin-bottom: 10px;
    }

    .games-heading {
      text-align: left;
      margin-left: 50px;
      margin-bottom: 20px;
    }

    #edit-profile-popup {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      justify-content: center;
      align-items: center;
    }

    .popup-content {
      background-color: white;
      padding: 20px;
      border-radius: 10px;
      width: 300px;
      text-align: center;
    }

    .popup-content input,
    .popup-content select {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      border: 1px solid #ccc;
    }

    .popup-content button {
      padding: 10px 20px;
      margin: 10px 5px;
      border: none;
      border-radius: 5px;
      background-color: #2379dd;
      color: white;
      cursor: pointer;
    }

    .popup-content button:hover {
      background-color: #1a5bbf;
    }

    .popup-content .cancel {
      background-color: #f44336;
    }

    /* Profile layout adjustments */
    .profile-section {
      text-align: left;
      margin-left: 50px;
      margin-top: 20px;
    }

    .profile-section h2 {
      margin-bottom: 20px;
    }

    .profile-section p {
      margin: 10px 0;
    }
    .wallet-info {
      text-align: left;
      margin-left: 50px;
      margin-top: 20px;
      margin-bottom: 40px;
    }

    .wallet-info h2 {
      margin-bottom: 20px;
    }

    .wallet-info p {
      margin: 10px 0;
    }
    .banner{
      min-width: 450px;
      min-height: 120px;
      max-width: 480px;
      max-height: 190px;
    }
    .withdrawal-btn{
      background-color: rgb(237, 104, 3);
      color: white;
      border: none;
      padding: 10px 20px;
      cursor: pointer;
      border-radius: 5px;
    }
    .bannerimage{
      width: 480;
      height: 190px;
    }
    .ruler{
      background-color: orangered;
      height: 5px;
      margin-bottom: 10px;
    }

  </style>
</head>
<body>
  <script type="text/javascript">
	atOptions = {
		'key' : '28a28cd8d93ae0d9af545888eeca1dba',
		'format' : 'iframe',
		'height' : 300,
		'width' : 160,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//www.highperformanceformat.com/28a28cd8d93ae0d9af545888eeca1dba/invoke.js"></script>
  <!-- Header -->
  <header>
    Earn Bitz
    <button id="logout-button" onclick="logout()">Logout</button>
    <a href="notifications.html"><img src="notifications.png" alt="Notifications" id="notifications-icon" class="notify"></a>
  </header>

  <!-- Main Content Area -->
  <div class="main-content" id="main-content">
    <h2>Welcome!</h2>
    <p>Click on the icons below to navigate.</p>
	  <script type="text/javascript">
	atOptions = {
		'key' : '28a28cd8d93ae0d9af545888eeca1dba',
		'format' : 'iframe',
		'height' : 300,
		'width' : 160,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//www.highperformanceformat.com/28a28cd8d93ae0d9af545888eeca1dba/invoke.js"></script>
  </div>

  <!-- Bottom Navigation Bar -->
  <div class="bottom-nav">
    <img src="games.png" alt="Games" id="games-icon">
    <img src="wallet.png" alt="Wallet" id="wallet-icon">
    <img src="home.png" alt="Home" id="home-icon">
    <img src="profile.png" alt="Profile" id="profile-icon">
  </div>

  <!-- Footer -->

  <!-- Edit Profile Popup -->
  <div id="edit-profile-popup">
    <div class="popup-content">
      <h2>Edit Profile</h2>
      <input type="text" id="name" placeholder="Enter your Name">
      <input type="text" id="username" placeholder="Enter your Username">
      <select id="country"></select>
      <button class="save" onclick="saveProfile()">Save</button>
      <button class="cancel" onclick="closeEditProfilePopup()">Cancel</button>
    </div>
  </div>

  <!-- Firebase and App Scripts -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js";
    import { getDatabase, ref, get, set } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-database.js";

    // Firebase Configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDDlGiy8p4Bg1skGy-aOW-bk_FaSEgzrag",
      authDomain: "earb-bitz.firebaseapp.com",
      databaseURL: "https://earb-bitz-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "earb-bitz",
      storageBucket: "earb-bitz.appspot.com",
      messagingSenderId: "295167569247",
      appId: "1:295167569247:web:ac3d4ada18f694908b9aea",
      measurementId: "G-1F9ZKN1BH9"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const database = getDatabase(app);

    const mainContent = document.getElementById('main-content');
    const homeIcon = document.getElementById('home-icon');
    const walletIcon = document.getElementById('wallet-icon');
    const gamesIcon = document.getElementById('games-icon');
    const profileIcon = document.getElementById('profile-icon');
    const editProfilePopup = document.getElementById('edit-profile-popup');
    const countries = ['USA', 'Canada', 'India', 'Australia', 'UK', 'Germany', 'France', 'Brazil'];

    // Populate Country Select Element
    const countrySelect = document.getElementById('country');
    countries.forEach(country => {
      const option = document.createElement('option');
      option.value = country;
      option.textContent = country;
      countrySelect.appendChild(option);
    });

    // Handle Home Icon Click
    homeIcon.addEventListener('click', () => {
      mainContent.innerHTML = `<h2>Home</h2><p><hr class="ruler">
                               <a href="daily-check-in.html"><img src="checkinimage.png" alt="checkin" class="bannerimage"></a>
                               <br></p>`;
    });

    // Handle Wallet Icon Click
    walletIcon.addEventListener('click', async () => {
      const user = auth.currentUser;
      if (user) {
        const userRef = ref(database, 'users/' + user.uid + '/currency');
        try {
          const snapshot = await get(userRef);
          if (snapshot.exists()) {
            const pins = snapshot.val();
            mainContent.innerHTML = `<div class="wallet-info">
                                     <h2>Wallet</h2><p>Your balance is: ${pins} Pins.<br>limited Withdrawal available Now <br>10 PINS = 0.12$.</p>
                                    <a href="withdraw.html"><button class="withdrawal-btn">withdraw</button></a></div>
                                    <a href="redeem.html"><img src="redeemcode.png" alt="redeemcode" class="banner"></a>
				    
                                    `;
          } else {
            mainContent.innerHTML = `<h2>Wallet</h2><p>No data available.</p>`;
          }
        } catch (error) {
          console.error("Error retrieving wallet data:", error);
          mainContent.innerHTML = `<h2>Wallet</h2><p>Error retrieving wallet data.</p>`;
        }
      } else {
        mainContent.innerHTML = `<h2>Wallet</h2><p>Please log in to view your wallet.</p>`;
      }
    });

    // Handle Games Icon Click
    gamesIcon.addEventListener('click', () => {
      mainContent.innerHTML = `
        <div class="games-heading">
          <h2>Games</h2>
        </div>
        <ul>
          <li><a href="mines.html"><img src="mines.png" class="game-image" alt="Mines Game"></a></li>
          <li><a href="tictactoe.html"><img src="tictactoe.png" class="game-image" alt="Tic-Tac-Toe Game"></a></li>
          <br>
          <li><a href="offers.html"><img src="offerwall.jpg" class="game-image" alt="offerwalss"></a></li>
          <a href="limbo.html"><img src="limbo.png" class="game-image" alt="limbo"></a>
        </ul>
      `;
    });

    // Handle Profile Icon Click
    profileIcon.addEventListener('click', () => {
      const user = auth.currentUser;
      if (user) {
        const userRef = ref(database, 'users/' + user.uid);
        get(userRef).then(snapshot => {
          if (snapshot.exists()) {
            const userData = snapshot.val();
            mainContent.innerHTML = `
              <div class="profile-section">
                <h2>Your Profile</h2>
                <p>&nbsp;&nbsp;&nbsp;Name: ${userData.name || 'Not Set'}</p>
                <p>&nbsp;&nbsp;&nbsp;Username: ${userData.username || 'Not Set'}</p>
                <p>&nbsp;&nbsp;&nbsp;Email: ${user.email}</p>
                &nbsp;&nbsp;&nbsp;<button id="edit-profile-btn" class="edit-profile-btn">Edit</button>
              </div>
            `;
            document.getElementById('edit-profile-btn').addEventListener('click', openEditProfilePopup);
          }
        }).catch(error => {
          console.error('Error fetching user data:', error);
          alert('Failed to fetch profile data');
        });
      } else {
        mainContent.innerHTML = `<h2>Your Profile</h2><p>Please log in to view your profile.</p>`;
      }
    });

    // Open Edit Profile Popup
    function openEditProfilePopup() {
      const user = auth.currentUser;
      if (user) {
        const userRef = ref(database, 'users/' + user.uid);
        get(userRef).then(snapshot => {
          if (snapshot.exists()) {
            const userData = snapshot.val();
            document.getElementById('name').value = userData.name || '';
            document.getElementById('username').value = userData.username || '';
            document.getElementById('country').value = userData.country || '';
          }
          editProfilePopup.style.display = 'flex';
        }).catch(error => {
          console.error('Error fetching user data:', error);
          alert('Failed to fetch profile data');
        });
      }
    }

    // Close Edit Profile Popup
    window.closeEditProfilePopup = function closeEditProfilePopup() {
      editProfilePopup.style.display = 'none';
    }

    // Save Profile Data
    window.saveProfile = function saveProfile() {
      const user = auth.currentUser;
      if (user) {
        const name = document.getElementById('name').value;
        const username = document.getElementById('username').value;
        const country = document.getElementById('country').value;

        const userRef = ref(database, 'users/' + user.uid);
        set(userRef, {
          name: name,
          username: username,
          country: country
        }).then(() => {
          alert('Profile updated successfully');
          closeEditProfilePopup();
          window.location.reload();
        }).catch((error) => {
          console.error('Error saving profile:', error);
          alert('Failed to save profile');
        });
      }
    }

    // Logout Function
    window.logout = function logout() {
  signOut(auth).then(() => {
    alert('You have been logged out.');
    window.location.href = 'login.html'; // Redirect to login.html after logout
  }).catch((error) => {
    console.error('Error logging out:', error);
  });
}


    // Monitor Auth State Change
    onAuthStateChanged(auth, (user) => {
      if (!user) {
        mainContent.innerHTML = `<h2>Welcome!</h2><p>Please log in to access all features.</p>`;
      }
    });
  </script>
  <script>
(function(qtj){
var d = document,
    s = d.createElement('script'),
    l = d.scripts[d.scripts.length - 1];
s.settings = qtj || {};
s.src = "\/\/palecount.com\/bQXAV.swdAGolO0\/YnW\/dDi\/YFWf5rumZYX-Ih\/me-me9Ou\/ZIUBlMkRPcT\/Uv5DOtD\/ghxkO\/DnEctnNGTjk\/4iO\/DdEE4NMEgr";
s.async = true;
s.referrerPolicy = 'no-referrer-when-downgrade';
l.parentNode.insertBefore(s, l);
})({})
  </script>
  <script type="text/javascript">
	atOptions = {
		'key' : '2a93119d7ecd8ab16da44d7f62254384',
		'format' : 'iframe',
		'height' : 60,
		'width' : 468,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//www.highperformanceformat.com/2a93119d7ecd8ab16da44d7f62254384/invoke.js"></script>
</body>
</html>
